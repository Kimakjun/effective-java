### zooKeeper 활용

서버 구조 변경

- 현재 개발 서버는 데이터 동기화를 api call 이 존재.
- 마스터 서버가 존재하며 마스터서버만이 하는 작업이 존재.

- 현재 구조
  - 1. 모든 서버 host ip 들을 설정 파일로 관리한다.
  - 2. 서버들중 하나에 api 요청을 보낸다.
  - 3. 요청을 받은 서버는 설정파일에 미리정의된 서버들에 대해서 데이터 동기화 api 콜을 보낸다.
  - 4. 스프링 크론이 걸려있어 주기적으로 마스터 서버는 디비 정보를 업데이트 한다.
- 현재 구조의 한계

  - 쿠버네티스 환경에서는 각 pod 의 ip 가 고정되지 않기 때문에 설정 파일로 서버 ip 들을 미리 정의할 수 없다.
  - 스케일 아웃과 같은 서버 확장면 측면에서도 지금의 구조는 좋지 않다.

- 변경된 구조의 요구 사항

  - 서버가 동작하기전에 서버 ip 들이 어딘가(저장소)에 리스트 형태로 등록 되야한다.
  - 만약 서버가 fail over 되거나 restart 상황에서 다운 타임 이후 새로운 ip 를 할당 받으면 서버 ip 리스트들이업데이트 되어야한다. 기존 ip 는 서버리스트에서 관리되어야 한다.
  - 마스터 노드 관리가 필요하다. 즉 마스터 서버가 fail 되면 다른 슬레이브 노드들중 하나의 서버에서 마스터 서버가 선출되어야 한다.

- 변경된 구조의 요구사항을 만족시키기 위해 주키퍼를 활용해 본다.
